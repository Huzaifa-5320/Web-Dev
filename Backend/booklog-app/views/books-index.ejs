<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Huzaifa Ali — Books I've Read</title>
  <link rel="stylesheet" href="/styles.css">
</head>

<body>
  <header>
    <h1>Huzaifa Ali</h1>
    <p class="subtitle">Books I’ve Read</p>
  </header>

  <main>
    <a href="/add" class="btn" style="margin:20px; display:inline-block;">+ Add New Book</a>

    <ul class="grid">
      <% books.forEach(b=> { %>
        <li class="card">
          <% if (b.isbn13 || b.isbn10) { %>
            <img src="https://covers.openlibrary.org/b/isbn/<%= b.isbn13 || b.isbn10 %>-M.jpg?default=false"
              alt="Cover of <%= b.title %>" />
            <% } %>
              <div class="meta">
                <h3>
                  <%= b.title %>
                </h3>
                <p class="author">
                  <%= b.author %>
                </p>
                <% if (b.rating) { %>
                  <p class="rating">
                    <%= b.rating %>/10
                  </p>
                  <% } %>
                    <% if (b.summary) { %>
                      <p class="summary">
                        <%= b.summary %>
                      </p>
                      <% } %>
              </div>

              <div class="actions">
                <% if (b.notes) { %>
                  <a href="/notes/<%= b.id %>" class="btn">Read Notes</a>
                  <% } %>
                    <a href="/edit/<%= b.id %>" class="btn">Edit</a>
                     <a href="/delete/<%= b.id %>" class="btn delete-link" data-title="<%= b.title %>">Delete</a>

              </div>

        </li>
        <% }) %>
    </ul>
  </main>
    <!-- Delete Confirmation Modal -->
  <div id="deleteModal" class="modal">
    <div class="modal-content">
      <h2>Confirm Delete</h2>
      <p id="modalMessage">Are you sure you want to delete this book?</p>
      <div class="modal-actions">
        <button id="cancelBtn" class="btn cancel">Cancel</button>
        <a id="confirmDelete" class="btn delete">Delete</a>
      </div>
    </div>
  </div>
<script>
  const modal = document.getElementById("deleteModal");
  const cancelBtn = document.getElementById("cancelBtn");
  const confirmDelete = document.getElementById("confirmDelete");

  document.querySelectorAll(".delete-link").forEach(link => {
    link.addEventListener("click", e => {
      e.preventDefault();
      const bookTitle = link.dataset.title;
      const deleteUrl = link.getAttribute("href");

      document.getElementById("modalMessage").textContent = 
        `Are you sure you want to delete "${bookTitle}"?`;

      confirmDelete.setAttribute("href", deleteUrl);
      modal.style.display = "flex";
    });
  });

  cancelBtn.addEventListener("click", () => {
    modal.style.display = "none";
  });

  window.addEventListener("click", e => {
    if (e.target === modal) modal.style.display = "none";
  });
</script>
</body>

</html>